<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">




<script>
    (function(){
        if(''){
            if (prompt('Password:') !== ''){
                alert('Error！');
                history.back();
            }
        }
    })();
</script>



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/rose.jpeg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/rose.jpeg?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Envoy,">










<meta name="description" content="Causality of Service Mesh对于简单的、单一规模的系统，解决其日渐增大的复杂度的首选方法是尽可能多地减少remote interactions远程交互，因为处理分布式问题最安全的措施就是避免分布式，即使中心式的系统架构意味着duplicated logic &amp;amp; data across various system。 But……，是的。很多时候，人们为了交流顺利会提前阐">
<meta name="keywords" content="Envoy">
<meta property="og:type" content="article">
<meta property="og:title" content="Introduction to Service Mesh">
<meta property="og:url" content="https://leopold-sun.github.io/service-mesh.html">
<meta property="og:site_name" content="INFINITE">
<meta property="og:description" content="Causality of Service Mesh对于简单的、单一规模的系统，解决其日渐增大的复杂度的首选方法是尽可能多地减少remote interactions远程交互，因为处理分布式问题最安全的措施就是避免分布式，即使中心式的系统架构意味着duplicated logic &amp;amp; data across various system。 But……，是的。很多时候，人们为了交流顺利会提前阐">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/NC-1.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/NC-2.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/NC-3.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/NC-4.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/MS-1.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/MS-2.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/MS-3.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/MS-4.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/envoy/sidecar.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/SM-1.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/SM-2.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/SM-3.png">
<meta property="og:image" content="https://leopold-sun.github.io/images/service-mesh/SM-4.png">
<meta property="og:updated_time" content="2019-01-10T06:48:36.257Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Introduction to Service Mesh">
<meta name="twitter:description" content="Causality of Service Mesh对于简单的、单一规模的系统，解决其日渐增大的复杂度的首选方法是尽可能多地减少remote interactions远程交互，因为处理分布式问题最安全的措施就是避免分布式，即使中心式的系统架构意味着duplicated logic &amp;amp; data across various system。 But……，是的。很多时候，人们为了交流顺利会提前阐">
<meta name="twitter:image" content="https://leopold-sun.github.io/images/service-mesh/NC-1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"right","display":"hide","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://leopold-sun.github.io/service-mesh.html">





  <title>Introduction to Service Mesh | INFINITE</title>
  








  <script type="text/javascript" src="/js/src/love.js"></script>
</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">INFINITE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">银月无迹   洛水焉痕   陌上花开   氤氲清浅</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-leopold-seagal">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            Leopold-Seagal
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix" style="display: none;">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://leopold-sun.github.io/service-mesh.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Leopold.Seagal">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/europe-man.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="INFINITE">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Introduction to Service Mesh</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-03T16:08:40+08:00">
                2019-01-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Envoy/" itemprop="url" rel="index">
                    <span itemprop="name">Envoy</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Causality-of-Service-Mesh"><a href="#Causality-of-Service-Mesh" class="headerlink" title="Causality of Service Mesh"></a>Causality of Service Mesh</h1><p>对于简单的、单一规模的系统，解决其日渐增大的复杂度的首选方法是尽可能多地减少<code>remote interactions</code>远程交互，因为处理分布式问题最安全的措施就是避免分布式，即使中心式的系统架构意味着<code>duplicated logic &amp; data across various system</code>。</p>
<p>But……，是的。很多时候，人们为了交流顺利会提前阐述完整或者必须的前提(preliminary),而真正的观点或重要的事情都会放在<mark>BUT</mark>之后展开。</p>
<p>当服务的形式不再局限与单物理机和单一机柜、机房中，被拓展至云端，而且为了开发、维护等复杂度的降低而被切分为<code>microservices</code>后，用Gateway的方式优化微服务架构对微服务数量庞大的架构来说可不是首选方案。<del>那么，service mesh出现了。</del></p>
<a id="more"></a>
<hr>
<h1 id="What-is-Network-Computers"><a href="#What-is-Network-Computers" class="headerlink" title="What is Network Computers?"></a>What is Network Computers?</h1><blockquote>
<p><a href="http://philcalcado.com/2017/08/03/pattern_service_mesh.html" target="_blank" rel="noopener">Pattern: Service Mesh</a></p>
</blockquote>
<ol>
<li>If two computers talk to each other.<br> <img src="/images/service-mesh/NC-1.png" alt=""></li>
<li>Oversimplified view on two services talking to each other for some partiicular goals.<br> <img src="/images/service-mesh/NC-2.png" alt=""><blockquote>
<p>为保证网络通信QoS，需要明确机器发现机制、同步连接处理、间接访问、路由、加密等实现细节。<br>以<mark>flow control</mark>为例，服务器发送的包不会超出下游服务器的处理容量。</p>
</blockquote>
</li>
<li>Applications or services logic contains flow control<br> <img src="/images/service-mesh/NC-3.png" alt=""></li>
<li>Flow controls as standards like TCP/IP that are extracted to the underlying network layer<br> <img src="/images/service-mesh/NC-4.png" alt=""></li>
</ol>
<hr>
<h1 id="What-about-Microservices"><a href="#What-about-Microservices" class="headerlink" title="What about Microservices?"></a>What about Microservices?</h1><blockquote>
<p>在传统模式下，如果微服务之间要进行通信，那么程序需要自己处理各种通信的细节，这就包括服务发现、熔断机制、超时重试和 tracing 等功能。这些功能通常实现为与某种编程语言相关的 library，这也导致了这样的 library 无法在不同的编程语言之间共享。<a href="http://senlinzhan.github.io/2017/12/25/envoy/" target="_blank" rel="noopener">senlinzhan</a></p>
</blockquote>
<p>逐渐增多的节点与状态链接，工业界的网络系统发展包括<code>fine-grained distributed agents and objects</code>、<code>Service-Oriented Architectures</code>。相较而言，微服务的架构比这二者分布的程度更高，也需要考虑一下几种关键因素</p>
<ul>
<li>Rapid provisioning of compute resources</li>
<li>Basic monitoring</li>
<li>Rapid deployment</li>
<li>Easy to provision storage</li>
<li>Easy access to the edge</li>
<li>Authentication/Authorisation</li>
<li>Standardised RPC</li>
</ul>
<h2 id="以-Service-Discovery-与-Circuit-Breakers-为例"><a href="#以-Service-Discovery-与-Circuit-Breakers-为例" class="headerlink" title="以 Service Discovery 与 Circuit Breakers 为例"></a>以 Service Discovery 与 Circuit Breakers 为例</h2><p>此二者皆是用于提高分布式系统的弹性（resiliency）和上述的几个挑战。</p>
<h3 id="什么是-Service-Discovery"><a href="#什么是-Service-Discovery" class="headerlink" title="什么是 Service Discovery"></a>什么是 Service Discovery</h3><blockquote>
<p>Service discovery is the process of automatically finding what instances of service fulfill a given query, e.g. a service called <mark>Teams</mark> needs to find instances of a service called <mark>Players</mark> with the attribute <mark>environment</mark> set to <mark>production</mark>. <a href="http://philcalcado.com/2017/08/03/pattern_service_mesh.html" target="_blank" rel="noopener">Pattern: Service Mesh</a></p>
</blockquote>
<p>在单一化的架构中，服务发现是一个由DNS、LB、端口约定（Http-8080）完成的简单task。</p>
<p>而分布式场景下，服务发现可能因为客户端的LB、异构环境、地理位置等因素而变得复杂。</p>
<h3 id="什么是-Circuit-Breakers"><a href="#什么是-Circuit-Breakers" class="headerlink" title="什么是 Circuit Breakers"></a>什么是 Circuit Breakers</h3><blockquote>
<p>Circuit breakers are a pattern catalogued by Michael Nygard in his book <strong>Release It</strong>.<br>The basic idea behind the circuit breaker is very simple. You wrap a protected function call in a circuit breaker object, which monitors for failures. Once the failures reach a certain threshold, the circuit breaker trips, and all further calls to the circuit breaker return with an error, without the protected call being made at all. Usually you’ll also want some kind of monitor alert if the circuit breaker trips. <a href="https://martinfowler.com/bliki/CircuitBreaker.html" target="_blank" rel="noopener">martinfowler</a></p>
</blockquote>
<h3 id="前期微服务架构"><a href="#前期微服务架构" class="headerlink" title="前期微服务架构"></a>前期微服务架构</h3><p><img src="/images/service-mesh/MS-1.png" alt=""><br>与前期的网络通信系统类似，服务对于请求的处理逻辑全部交于服务开发者来做，包含上面列的几个关键挑战因素。</p>
<h3 id="Netflix-Twitter-SoundCloud-microservice-architecture"><a href="#Netflix-Twitter-SoundCloud-microservice-architecture" class="headerlink" title="Netflix/Twitter/SoundCloud microservice architecture"></a>Netflix/Twitter/SoundCloud microservice architecture</h3><p><img src="/images/service-mesh/MS-2.png" alt=""><br>其一，随着分布的服务数量增多，其可靠性也逐渐降低;其二，限制了微服务的开发工具、语言和运行时;其三，维护成本大。</p>
<h3 id="Extract-the-complicated-features-form-service-logic-to-the-underlying-platform"><a href="#Extract-the-complicated-features-form-service-logic-to-the-underlying-platform" class="headerlink" title="Extract the complicated features form service logic to the underlying platform"></a>Extract the complicated features form service logic to the underlying platform</h3><p><img src="/images/service-mesh/MS-3.png" alt=""><br>解放开发者以专注与服务基本逻辑。但将这些服务特征放入协议栈是不可行的，而是以代理的形式被实现在服务逻辑之外。</p>
<h3 id="Here-comes-the-sidecar-concept"><a href="#Here-comes-the-sidecar-concept" class="headerlink" title="Here comes the sidecar concept"></a>Here comes the sidecar concept</h3><p><img src="/images/service-mesh/MS-4.png" alt=""></p>
<blockquote>
<p>Use cases: Linkerd、Envoy</p>
</blockquote>
<p>既然不同的service所实现的不同功能使得最终得到的不兼容、编程语言不同的<code>Libraries</code>之间无法共享，那么不如将这部分<code>libraries</code>剥离开作为独立的进程运行，而剥离开的<code>function library</code>也被通俗地称为<code>sidecar</code>。</p>
<h4 id="service-co-located-with-“sidecar”"><a href="#service-co-located-with-“sidecar”" class="headerlink" title="service co-located with “sidecar”"></a>service co-located with “sidecar”</h4><p><img src="/images/envoy/sidecar.png" alt=""></p>
<p>一般来说，可以选择将<code>sidecar</code>与<code>service</code>一起部署，比如放到同一个<code>container</code>中，那么该<code>service</code>的所有流量（包含<code>ingress flow</code>和<code>egress flow</code>）都交由<code>sidecar</code>代理。在此基础上，也可以为<code>sidecar</code>添加服务发现、熔断机制和超时重传等功能。</p>
<hr>
<h1 id="What-is-Service-Mesh"><a href="#What-is-Service-Mesh" class="headerlink" title="What is Service Mesh?"></a>What is Service Mesh?</h1><p><img src="/images/service-mesh/SM-1.png" alt=""></p>
<blockquote>
<p>The term <mark>service mesh</mark> is used to describe the network of microservices that make up such applications and the interactions between them. As a service mesh grows in size and complexity, it can become harder to understand and manage. Its requirements can include discovery, load balancing, failure recovery, metrics, and monitoring. A service mesh also often has more complex operational requirements, like A/B testing, canary releases, rate limiting, access control, and end-to-end authentication. <a href="https://istio.io/docs/concepts/what-is-istio/" target="_blank" rel="noopener">lstio-concepts</a><br>A service mesh is a dedicated infrastructure layer for handling service-to-service communication. It’s responsible for the reliable delivery of requests through the complex topology of services that comprise a modern, cloud native application. In practice, the service mesh is typically implemented as an array of lightweight network proxies that are deployed alongside application code, without the application needing to be aware.<br>The concept of the service mesh as a separate layer is tied to the rise of the cloud native application. In the cloud native model, a single application might consist of hundreds of services; each service might have thousands of instances; and each of those instances might be in a constantly-changing state as they are dynamically scheduled by an orchestrator like Kubernetes. Not only is service communication in this world incredibly complex, it’s a pervasive and fundamental part of runtime behavior. Managing it is vital to ensuring end-to-end performance and reliability.<a href="https://blog.buoyant.io/2017/04/25/whats-a-service-mesh-and-why-do-i-need-one/" target="_blank" rel="noopener">What’s a service mesh? And why do I need one?</a></p>
</blockquote>
<p><img src="/images/service-mesh/SM-2.png" alt=""></p>
<h2 id="Transfer-microservice-to-service-mesh"><a href="#Transfer-microservice-to-service-mesh" class="headerlink" title="Transfer microservice to service mesh"></a>Transfer microservice to service mesh</h2><p><img src="/images/service-mesh/SM-3.png" alt=""><br>网络服务依然在代理之间进行通信，但是<mark>Control Plane</mark>知道所有<code>proxy insatnces</code>的信息。通过代理之间的合作，可以实现一些对数据流的观察数据，比如<code>access control</code>、<code>metrics collection</code>。<br><img src="/images/service-mesh/SM-4.png" alt=""></p>
<hr>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://istio.io/docs/concepts/what-is-istio/" target="_blank" rel="noopener">what is lstio</a></li>
<li><a href="http://philcalcado.com/2017/08/03/pattern_service_mesh.html" target="_blank" rel="noopener">Pattern: Service Mesh</a></li>
<li><a href="https://liudanking.com/tag/envoy/" target="_blank" rel="noopener">Service Mesh 及其主流开源实现解析</a></li>
<li><a href="https://blog.buoyant.io/2017/04/25/whats-a-service-mesh-and-why-do-i-need-one/" target="_blank" rel="noopener">What’s a service mesh? And why do I need one?</a></li>
<li><a href="http://senlinzhan.github.io/2017/12/25/envoy/" target="_blank" rel="noopener">Envoy Proxy 与微服务实践</a></li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Envoy/" rel="tag"><i class="fa fa-tag"></i>

 Envoy</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/docker-installation.html" rel="prev" title="docker installation">
                <i class="fa fa-chevron-left"></i> docker installation
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Compile-Envoy.html" rel="next" title="Compile Envoy">
                Compile Envoy <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/europe-man.jpg" alt="Leopold.Seagal">
            
              <p class="site-author-name" itemprop="name">Leopold.Seagal</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Leopold-Sun" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:markyeap@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://dev.tencent.com/u/Leopold-Seagal" target="_blank" title="Coding">
                      
                        <i class="fa fa-fw fa-code"></i>Coding</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://tsnest.cc/forum.php/" title="天使领域" target="_blank" rel="external nofollow">天使领域</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hycdes.com/" title="少女前线" target="_blank" rel="external nofollow">少女前线</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hycdes.github.io/" title="命运の乐章" target="_blank" rel="external nofollow">命运の乐章</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.damien.ink/" title="Damien丶泽宇" target="_blank" rel="external nofollow">Damien丶泽宇</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.runoob.com/" title="菜鸟教程" target="_blank" rel="external nofollow">菜鸟教程</a>
                  </li>
                
              </ul>
            </div>
          

          <div id="days"></div>
<script>
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("12/20/2018 15:13:14");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="Age:"+daysold+" D "+hrsold+" H "+minsold+" M "+seconds+" S ";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Causality-of-Service-Mesh"><span class="nav-number">1.</span> <span class="nav-text">Causality of Service Mesh</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#What-is-Network-Computers"><span class="nav-number">2.</span> <span class="nav-text">What is Network Computers?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#What-about-Microservices"><span class="nav-number">3.</span> <span class="nav-text">What about Microservices?</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#以-Service-Discovery-与-Circuit-Breakers-为例"><span class="nav-number">3.1.</span> <span class="nav-text">以 Service Discovery 与 Circuit Breakers 为例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是-Service-Discovery"><span class="nav-number">3.1.1.</span> <span class="nav-text">什么是 Service Discovery</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是-Circuit-Breakers"><span class="nav-number">3.1.2.</span> <span class="nav-text">什么是 Circuit Breakers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前期微服务架构"><span class="nav-number">3.1.3.</span> <span class="nav-text">前期微服务架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Netflix-Twitter-SoundCloud-microservice-architecture"><span class="nav-number">3.1.4.</span> <span class="nav-text">Netflix/Twitter/SoundCloud microservice architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Extract-the-complicated-features-form-service-logic-to-the-underlying-platform"><span class="nav-number">3.1.5.</span> <span class="nav-text">Extract the complicated features form service logic to the underlying platform</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Here-comes-the-sidecar-concept"><span class="nav-number">3.1.6.</span> <span class="nav-text">Here comes the sidecar concept</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#service-co-located-with-“sidecar”"><span class="nav-number">3.1.6.1.</span> <span class="nav-text">service co-located with “sidecar”</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#What-is-Service-Mesh"><span class="nav-number">4.</span> <span class="nav-text">What is Service Mesh?</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Transfer-microservice-to-service-mesh"><span class="nav-number">4.1.</span> <span class="nav-text">Transfer microservice to service mesh</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">5.</span> <span class="nav-text">References</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Leopold.Seagal</span>

  
</div>






  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  














  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  


</body>
</html>
